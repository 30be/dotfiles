#!/usr/bin/env bash
set -eo pipefail
export VENV_HOME="$HOME/.virtualenvs"
[[ -d $VENV_HOME ]] || mkdir $VENV_HOME

if [ $# -eq 0 ]; then
  echo "Usage: venv <command> [name]"
  echo "Commands: ls, mk, rm, <venv-name>"
  exit 1
fi

command="$1"
name="$2"

case "$command" in
ls)
  ls -1 "$VENV_HOME"
  ;;
mk)
  if [ -z "$name" ]; then
    echo "Please provide venv name for 'mk'"
    exit 1
  fi
  python3 -m venv "$VENV_HOME/$name"
  ;;
rm)
  if [ -z "$name" ]; then
    echo "Please provide venv name for 'rm'"
    exit 1
  fi
  rm -r "$VENV_HOME/$name"
  ;;
*)
  source "$VENV_HOME/$command/bin/activate"
  ;;
esac

exec $SHELL -i
