#!/usr/bin/env bash
set -euo pipefail

export VENV_HOME="$HOME/.virtualenvs"
[[ -d $VENV_HOME ]] || mkdir $VENV_HOME

if [ $# -eq 0 ]; then
  echo "Usage: venv <command> [name]"
  echo "Commands: ls, mk, rm, source"
  return 1
fi

local command="$1"
local name="$2"

case "$command" in
ls)
  ls -1 "$VENV_HOME"
  ;;
mk)
  if [ -z "$name" ]; then
    echo "Please provide venv name for 'mk'"
    return 1
  fi
  python3 -m venv "$VENV_HOME/$name"
  ;;
rm)
  if [ -z "$name" ]; then
    echo "Please provide venv name for 'rm'"
    return 1
  fi
  rm -r "$VENV_HOME/$name"
  ;;
source)
  if [ -z "$name" ]; then
    echo "Please provide venv name for 'source'"
    return 1
  fi
  source "$VENV_HOME/$name/bin/activate"
  ;;
*)
  echo "Invalid command: $command"
  echo "Commands: ls, mk, rm, source"
  return 1
  ;;
esac
